- step:
    name: run-model
    image: python:3.10
    command:
    - python model.py

- endpoint:
    name: loyalty-sample
    image: tiangolo/uvicorn-gunicorn-fastapi:python3.7
    server-command: uvicorn loyalty_app:app --host 0.0.0.0 --port 8000
    port: 8000
    files:
      - name: data
        description: Customer Loyalty data
        path: data.csv

- endpoint:
    name: r-shiny
    image: r-base:4.3.2
    server-command: library(shiny) && runApp("r_demo")
    port: 6205

- pipeline:
    name: deploy
    nodes:
    - name: model
      type: execution
      step: run-model
    - name: deploy
      type: deployment
      deployment: loyalty-sample
      actions:
      - when: node-starting
        then: require-approval
      endpoints:
        - loyalty-sample
    edges:
    - [model.output.*.csv, deploy.file.loyalty-sample.data]

- endpoint:
    name: streamlit-sample
    image: docker.io/drazend/streamlit 
    server-command: pip install watchdog && streamlit run lit.py
    port: 8502